### RSA算法理解



### 必知概念

---

- **对称加密算法**（Symmetric-key algorithm）：由于加密和解密使用同样规则（简称"密钥"）。
- **非对称加密算法**：加密和解密可以使用不同的规则，只要这两种规则之间存在某种对应关系即可，这样就避免了直接传递密钥。

- **RSA算法**：三位数学家Rivest、Shamir 和 Adleman 设计了一种算法，该算法以他们的名字命名。RSA算法一直是最广为使用的"非对称加密算法"。
- **密钥**：加解密规则。公钥和私钥是密钥的具体分类。

- **RSA安全性**：密钥越长，它就越难破解。目前被破解的最长RSA密钥是768个二进制位。因此可以认为，1024位的RSA密钥基本安全，2048位的密钥极其安全。



### 核心理念

---

RSA算法基于一个十分简单的数论事实：将两个大素数相乘十分容易，但那时想要对其乘积进行因式分解却极其困难，因此可以将乘积公开作为加密密钥。

换句话说：基于目前未解决的数学难题，正着容易反着难。



### 加解密流程

---

RSA是基于互质的p和q，算出pq乘积n容易，翻过来根据n求解互质的p和q困难实现的。

1、取p和q两个互质的质数，一般情况下是1024位或者2048位

比如我取了61和53

2、计算乘积n

n=p*q=3233 (二进制110010100001，只有12位)

3、计算n的欧拉函数φ(n)

φ(n) = φ§*φ(q)= (p-1)(q-1) = 3120 。一个质数p的欧拉函数等于p-1

4、随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质。

取e = 17 (实际应用中，常常选择65537)。

5、计算e对于φ(n)的模反元素d。

即找出一个d满足 ed互质，且对于φ(n) 取模为1 ，即 ed = 1 (mod φ(n))。即 e*d -1 = k*φ(n) ，带入上面已知条件：17*d -1 = k*3120 即 17x +3120y = 1 (据说可以使用 扩展欧几里得算法求解)

这里直接给出答案 d = 2753。

6、将n和e封装成公钥，n和d封装成私钥。

代入本次的推导过程中的数字，n = 3233,e = 17, d=2753。公钥为（3233，17），私钥为（3233，2723）。

> 加密使用 （3233，17），解密使用（3233，2723）。

7、公钥（n,e）加密

所有字符串都可以使用ascil码/unicode值来表示，假设一个字符 m = a，ascii码为65,需要满足 m < n 对他进行加密。

> m^e ≡ c (mod n),c为加密字符串
>
> n = 3233,e = 17。 上式可以表示为： (65^17)%3233 = c ,c = 2790。

8、私钥（n,d）解密

> (n,d) = (3233,2723) 。在拿到c = 2790之后，进行以下操作：
>
> c^d ≡ m (mod n) 即可得到m 。



### 小结

---

如果说，理解整个数学公式有困难的话，可以直接理解这个原理。

1、RSA是非对称加密算法。公钥和私钥是有关联的，而破解这个关联的关键是求解数学难题---大数质因数分解。

2、求解该数学难题目前只有暴力破解的方法，越长越难破解。

3、对外公开的公钥是正向结果n和衍生公式参数e；对内的私钥是n和衍生公式参数d；e对于φ(n)的模反元素是d。

4、衍生公式的意义在于引入φ(n)，让人很难通过n和e求得d。

5、这六个数字之中，加密的过程只涉及到e和n，而d，φ(n)，p和q无法涉及。	

6、其中最关键的是d，因为n和d组成了私钥，一旦d泄漏，就等于私钥泄漏。





### 参考资料

---

- http://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html
- https://blog.csdn.net/doujinlong1/article/details/82051986
- http://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html